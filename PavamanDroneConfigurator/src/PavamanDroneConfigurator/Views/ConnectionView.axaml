<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:PavamanDroneConfigurator.ViewModels"
             x:Class="PavamanDroneConfigurator.Views.ConnectionView"
             x:DataType="vm:ConnectionViewModel">

    <ScrollViewer>
        <StackPanel MaxWidth="800" Margin="16">
            <TextBlock Text="CONNECTION SETTINGS" Classes="section-header"/>

            <Border Classes="card">
                <StackPanel Spacing="16">
                    <!-- Connection Type -->
                    <StackPanel>
                        <TextBlock Text="COMM LINK SETTINGS" Classes="label"/>
                        <ComboBox SelectedIndex="{Binding SelectedConnectionType}" MinWidth="250">
                            <ComboBoxItem Content="Serial"/>
                            <ComboBoxItem Content="TCP"/>
                            <ComboBoxItem Content="UDP"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Serial Settings -->
                    <StackPanel IsVisible="{Binding SelectedConnectionType, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}">
                        <StackPanel Spacing="16">
                            <!-- Serial Port -->
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Spacing="8">
                                    <TextBlock Text="Serial Port" Classes="label"/>
                                    <Button Content="Refresh" Command="{Binding RefreshPortsCommand}" 
                                           Padding="8,4" FontSize="11"/>
                                </StackPanel>
                                <ComboBox ItemsSource="{Binding AvailablePorts}" 
                                         SelectedItem="{Binding SelectedPort}" 
                                         MinWidth="250"/>
                            </StackPanel>

                            <!-- Baud Rate -->
                            <StackPanel>
                                <TextBlock Text="Baud Rate" Classes="label"/>
                                <ComboBox ItemsSource="{Binding AvailableBaudRates}" 
                                         SelectedItem="{Binding SelectedBaudRate}" 
                                         MinWidth="250"/>
                            </StackPanel>

                            <!-- Data Bits -->
                            <StackPanel>
                                <TextBlock Text="Data Bits" Classes="label"/>
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <ToggleButton Classes="toggle-group" Content="6" 
                                                 IsChecked="{Binding SelectedDataBits, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=6}"/>
                                    <ToggleButton Classes="toggle-group" Content="7" 
                                                 IsChecked="{Binding SelectedDataBits, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=7}"/>
                                    <ToggleButton Classes="toggle-group" Content="8" 
                                                 IsChecked="{Binding SelectedDataBits, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=8}"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Parity -->
                            <StackPanel>
                                <TextBlock Text="Parity" Classes="label"/>
                                <StackPanel Orientation="Horizontal" Spacing="4">
                                    <ToggleButton Classes="toggle-group" Content="None" 
                                                 IsChecked="{Binding SelectedParity, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=0}"/>
                                    <ToggleButton Classes="toggle-group" Content="Even" 
                                                 IsChecked="{Binding SelectedParity, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=2}"/>
                                    <ToggleButton Classes="toggle-group" Content="Odd" 
                                                 IsChecked="{Binding SelectedParity, Converter={x:Static ObjectConverters.Equal}, ConverterParameter=1}"/>
                                </StackPanel>
                            </StackPanel>

                            <!-- Stop Bits -->
                            <StackPanel>
                                <TextBlock Text="Stop Bits" Classes="label"/>
                                <ComboBox SelectedIndex="{Binding SelectedStopBits}" MinWidth="250">
                                    <ComboBoxItem Content="None"/>
                                    <ComboBoxItem Content="One"/>
                                    <ComboBoxItem Content="Two"/>
                                </ComboBox>
                            </StackPanel>
                        </StackPanel>
                    </StackPanel>

                    <!-- TCP/UDP Settings -->
                    <StackPanel IsVisible="{Binding SelectedConnectionType, Converter={x:Static ObjectConverters.NotEqual}, ConverterParameter=0}" 
                               Spacing="16">
                        <StackPanel>
                            <TextBlock Text="Host / IP Address" Classes="label"/>
                            <TextBox Text="{Binding Host}" MinWidth="250"/>
                        </StackPanel>

                        <StackPanel>
                            <TextBlock Text="Port" Classes="label"/>
                            <TextBox Text="{Binding Port}" MinWidth="250"/>
                        </StackPanel>
                    </StackPanel>

                    <!-- Connection Status -->
                    <StackPanel>
                        <TextBlock Text="Status" Classes="label"/>
                        <TextBlock Text="{Binding ConnectionStatus}" Classes="status"/>
                    </StackPanel>

                    <!-- Connect/Disconnect Buttons -->
                    <StackPanel Orientation="Horizontal" Spacing="8" Margin="0,16,0,0">
                        <Button Classes="primary" Content="Connect" 
                               Command="{Binding ConnectCommand}"
                               IsEnabled="{Binding !IsConnected}"/>
                        <Button Classes="secondary" Content="Disconnect" 
                               Command="{Binding DisconnectCommand}"
                               IsEnabled="{Binding IsConnected}"/>
                    </StackPanel>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
