<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:PavamanDroneConfigurator.ViewModels"
        x:Class="PavamanDroneConfigurator.Views.ConnectionDialog"
        x:DataType="vm:ConnectionViewModel"
        Title="Connect to Drone"
        Width="700" Height="550"
        WindowStartupLocation="CenterScreen"
        CanResize="False"
        Background="#F5F5F5">
    
    <Grid Margin="24" RowDefinitions="Auto,*,Auto">
        
        <!-- Header -->
        <Border Grid.Row="0" 
                Padding="20" 
                CornerRadius="8" 
                Margin="0,0,0,24">
            <Border.Background>
                <LinearGradientBrush StartPoint="0%,0%" EndPoint="100%,100%">
                    <GradientStop Color="#4CAF50" Offset="0"/>
                    <GradientStop Color="#66BB6A" Offset="1"/>
                </LinearGradientBrush>
            </Border.Background>
            <StackPanel Orientation="Horizontal" Spacing="16">
                <!-- Icon -->
                <Border Width="50" Height="50" 
                        Background="White" 
                        CornerRadius="25"
                        Padding="8">
                    <Viewbox>
                        <Canvas Width="24" Height="24">
                            <Path Fill="#4CAF50" Data="M12,2L4.5,20.29L5.21,21L12,18L18.79,21L19.5,20.29L12,2Z"/>
                        </Canvas>
                    </Viewbox>
                </Border>
                
                <StackPanel VerticalAlignment="Center">
                    <TextBlock Text="Drone Connection Required" 
                              FontSize="22" 
                              FontWeight="Bold" 
                              Foreground="White"/>
                    <TextBlock Text="Please connect to your drone before proceeding" 
                              FontSize="13" 
                              Foreground="#E8F5E9"
                              Margin="0,4,0,0"/>
                </StackPanel>
            </StackPanel>
        </Border>

        <!-- Connection Settings -->
        <Border Grid.Row="1" 
                Background="White" 
                Padding="24" 
                CornerRadius="8" 
                BorderBrush="#E0E0E0" 
                BorderThickness="1"
                BoxShadow="0 2 8 0 #10000000">
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <StackPanel Spacing="20">
                    
                    <TextBlock Text="COMMUNICATION SETTINGS" 
                              FontSize="13" 
                              FontWeight="Bold" 
                              Foreground="#757575"
                              LetterSpacing="1"/>
                    
                    <!-- Connection Type -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Connection Type" 
                                  FontSize="13" 
                                  FontWeight="SemiBold"
                                  Foreground="#424242"/>
                        <ComboBox SelectedIndex="0" 
                                 Width="300" 
                                 HorizontalAlignment="Left"
                                 Height="36">
                            <ComboBoxItem Content="Serial Port"/>
                            <ComboBoxItem Content="TCP/UDP"/>
                        </ComboBox>
                    </StackPanel>

                    <!-- Serial Port -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Serial Port *" 
                                  FontSize="13" 
                                  FontWeight="SemiBold"
                                  Foreground="#424242"/>
                        <ComboBox ItemsSource="{Binding AvailablePorts}" 
                                 SelectedItem="{Binding SelectedPort}"
                                 Width="300" 
                                 HorizontalAlignment="Left"
                                 Height="36"
                                 PlaceholderText="Select port..."/>
                    </StackPanel>

                    <!-- Baud Rate -->
                    <StackPanel Spacing="8">
                        <TextBlock Text="Baud Rate *" 
                                  FontSize="13" 
                                  FontWeight="SemiBold"
                                  Foreground="#424242"/>
                        <ComboBox ItemsSource="{Binding AvailableBaudRates}" 
                                 SelectedItem="{Binding SelectedBaudRate}"
                                 Width="300" 
                                 HorizontalAlignment="Left"
                                 Height="36"/>
                    </StackPanel>

                    <!-- Status Panel -->
                    <Border Background="#E3F2FD" 
                            Padding="16" 
                            CornerRadius="6" 
                            Margin="0,12,0,0"
                            BorderBrush="#90CAF9"
                            BorderThickness="1">
                        <StackPanel Spacing="10">
                            <StackPanel Orientation="Horizontal" Spacing="8">
                                <TextBlock Text="Status:" 
                                          FontSize="13" 
                                          FontWeight="SemiBold" 
                                          Foreground="#1976D2"/>
                                <TextBlock Text="{Binding ConnectionStatus}" 
                                          FontSize="13"
                                          FontWeight="Medium"
                                          Foreground="#1976D2"/>
                            </StackPanel>
                            
                            <!-- Parameter Loading Progress -->
                            <StackPanel IsVisible="{Binding IsLoadingParameters}" Spacing="8">
                                <TextBlock Text="Loading parameters..." 
                                          FontSize="12"
                                          Foreground="#616161"/>
                                <ProgressBar IsIndeterminate="False"
                                            Value="{Binding ParametersLoaded}"
                                            Maximum="{Binding TotalParameters}"
                                            Height="6"
                                            Foreground="#4CAF50"
                                            Background="#E0E0E0"
                                            CornerRadius="3"/>
                                <TextBlock FontSize="11"
                                          Foreground="#757575">
                                    <Run Text="{Binding ParametersLoaded}"/>
                                    <Run Text="/"/>
                                    <Run Text="{Binding TotalParameters}"/>
                                    <Run Text=" parameters loaded"/>
                                </TextBlock>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                </StackPanel>
            </ScrollViewer>
        </Border>

        <!-- Action Buttons -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right" 
                    Spacing="12" 
                    Margin="0,24,0,0">
            <Button Content="Cancel" 
                    Width="120" 
                    Height="40"
                    Background="#F5F5F5"
                    Foreground="#424242"
                    FontSize="13"
                    FontWeight="SemiBold"
                    CornerRadius="6"
                    Click="OnCancelClicked"/>
            <Button Content="Connect" 
                    Command="{Binding ConnectCommand}"
                    Width="120" 
                    Height="40"
                    Background="#4CAF50" 
                    Foreground="White"
                    FontSize="13"
                    FontWeight="SemiBold"
                    CornerRadius="6"/>
        </StackPanel>
    </Grid>
</Window>