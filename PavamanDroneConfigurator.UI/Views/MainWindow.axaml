<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:PavamanDroneConfigurator.UI.ViewModels"
        xmlns:views="using:PavamanDroneConfigurator.UI.Views"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d" d:DesignWidth="1280" d:DesignHeight="800"
        x:Class="PavamanDroneConfigurator.UI.Views.MainWindow"
        x:DataType="vm:MainWindowViewModel"
        Title="pavaman Drone Configurator"
        Width="1280" 
        Height="800"
        MinWidth="1024"
        MinHeight="600"
        Icon="avares://PavamanDroneConfigurator.UI/Assets/Images/logo.ico"
        WindowStartupLocation="CenterScreen">

    <Design.DataContext>
        <vm:MainWindowViewModel/>
    </Design.DataContext>

    <Window.Styles>
        <!-- Modern Navigation Styles -->
        <Style Selector="Border.sidebar">
            <Setter Property="Background">
                <Setter.Value>
                    <LinearGradientBrush StartPoint="0%,0%" EndPoint="0%,100%">
                        <GradientStop Color="#1E3A8A" Offset="0"/>
                        <GradientStop Color="#1E40AF" Offset="1"/>
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
            <Setter Property="BoxShadow" Value="2 0 8 0 #40000000"/>
        </Style>

        <Style Selector="Button.nav-button">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Padding" Value="20,14"/>
            <Setter Property="Margin" Value="8,4"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
            <Setter Property="HorizontalContentAlignment" Value="Left"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>

        <Style Selector="Button.nav-button:pointerover">
            <Setter Property="Background" Value="#60FFFFFF"/>
        </Style>

        <Style Selector="Button.nav-button:pressed">
            <Setter Property="Background" Value="#40FFFFFF"/>
        </Style>

        <Style Selector="Button.nav-button:disabled">
            <Setter Property="Foreground" Value="#80FFFFFF"/>
            <Setter Property="Cursor" Value="Arrow"/>
        </Style>

        <Style Selector="Button.nav-button-active">
            <Setter Property="Background" Value="#3B82F6"/>
        </Style>

        <Style Selector="TextBlock.sidebar-title">
            <Setter Property="FontSize" Value="20"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
        </Style>

        <Style Selector="TextBlock.sidebar-subtitle">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Foreground" Value="#C7D2FE"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
    </Window.Styles>

    <Grid ColumnDefinitions="260,*">
        <!-- Modern Navigation Sidebar -->
        <Border Grid.Column="0" Classes="sidebar">
            <Grid RowDefinitions="Auto,*,Auto">
                <!-- App Branding (Fixed at top) -->
                <StackPanel Grid.Row="0" Spacing="4" Margin="16,24,16,0">
                    <!-- Logo -->
                    <Border Width="48" 
                            Height="48" 
                            CornerRadius="24"
                            Background="White"
                            Margin="0,0,0,12"
                            HorizontalAlignment="Left">
                        <Image Source="avares://PavamanDroneConfigurator.UI/Assets/Images/logo.ico"
                               Stretch="Uniform"
                               Margin="8"/>
                    </Border>
                    
                    <TextBlock Text="pavaman" Classes="sidebar-title"/>
                    <TextBlock Text="Drone Configurator" Classes="sidebar-subtitle"/>
                </StackPanel>

                <!-- Scrollable Navigation Menu -->
                <ScrollViewer Grid.Row="1" 
                              VerticalScrollBarVisibility="Auto"
                              HorizontalScrollBarVisibility="Disabled"
                              Margin="0,8,0,8">
                    <StackPanel Margin="16,0">
<<<<<<< Updated upstream
=======
                        <!-- Navigation Menu -->
>>>>>>> Stashed changes
                        <TextBlock Text="NAVIGATION" 
                                   FontSize="10" 
                                   FontWeight="Bold" 
                                   Foreground="#A5B4FC" 
                                   Margin="12,8,0,8"/>

                        <StackPanel x:Name="NavigationMenu" Spacing="4">
                            <Button Content="Connection" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ConnectionPage}" 
                                    Click="NavButton_Click" />

<<<<<<< Updated upstream
                            <Button Content="Drone Details" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding DroneDetailsPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Airframe" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding AirframePage}" 
                                    Click="NavButton_Click" 
                                    IsEnabled="{Binding CanAccessAirframe}" />

                            <Button Content="Flight Modes" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding FlightModesPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Motor and ESC" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding MotorEscPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="PID Tuning" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding PidTuningPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Serial Config" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding SerialConfigPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="RC Calibration" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding RcCalibrationPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Sensors" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding SensorsCalibrationPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Power" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding PowerPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Advanced Settings" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ParametersPage}" 
                                    Click="NavButton_Click" 
                                    IsEnabled="{Binding CanAccessParameters}" />

                            <Button Content="Safety" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding SafetyPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Profiles" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ProfilePage}" 
=======
                            <Button Content="Airframe" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding AirframePage}" 
                                    Click="NavButton_Click" 
                                    IsEnabled="{Binding CanAccessAirframe}" />

                            <Button Content="Flight Modes" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding FlightModesPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Motor &amp; ESC" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding MotorEscPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="PID Tuning" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding PidTuningPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Power" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding PowerPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Advanced Settings" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ParametersPage}" 
                                    Click="NavButton_Click" 
                                    IsEnabled="{Binding CanAccessParameters}" />

                            <Button Content="Calibration" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding CalibrationPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Safety" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding SafetyPage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Profiles" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ProfilePage}" 
                                    Click="NavButton_Click" />

                            <Button Content="Reset Parameters" 
                                    Classes="nav-button"
                                    CommandParameter="{Binding ResetParametersPage}" 
>>>>>>> Stashed changes
                                    Click="NavButton_Click" />
                        </StackPanel>
                    </StackPanel>
                </ScrollViewer>

                <!-- Version Info (Fixed at bottom) -->
<<<<<<< Updated upstream
                <Border Grid.Row="2"
=======
                <Border Grid.Row="2" 
>>>>>>> Stashed changes
                        Background="#20FFFFFF" 
                        CornerRadius="8" 
                        Padding="12" 
                        Margin="24,8,24,24">
                    <StackPanel Spacing="4">
                        <TextBlock Text="Version 1.0.0" 
                                   FontSize="11" 
                                   Foreground="#E0E7FF"
                                   FontWeight="SemiBold"/>
                        <TextBlock Text="Â© 2025 pavaman" 
                                   FontSize="10" 
                                   Foreground="#A5B4FC"/>
                    </StackPanel>
                </Border>
            </Grid>
        </Border>

        <!-- Content Area with modern background -->
        <Border Grid.Column="1" Background="#F9FAFB">
            <ContentControl Content="{Binding CurrentPage}">
                <ContentControl.DataTemplates>
                    <DataTemplate DataType="vm:ConnectionPageViewModel">
                        <views:ConnectionPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:DroneDetailsPageViewModel">
                        <views:DroneDetailsPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:ParametersPageViewModel">
                        <views:ParametersPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:AirframePageViewModel">
                        <views:AirframePage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:SafetyPageViewModel">
                        <views:SafetyPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:ProfilePageViewModel">
                        <views:ProfilePage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:FlightModePageViewModel">
                        <views:FlightModesPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:PowerPageViewModel">
                        <views:PowerPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:MotorEscPageViewModel">
                        <views:MotorEscPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:PidTuningPageViewModel">
                        <views:PidTuningPage />
                    </DataTemplate>
<<<<<<< Updated upstream
                    <DataTemplate DataType="vm:SerialConfigPageViewModel">
                        <views:SerialConfigPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:RcCalibrationPageViewModel">
                        <views:RcCalibrationPage />
                    </DataTemplate>
                    <DataTemplate DataType="vm:SensorsCalibrationPageViewModel">
                        <views:SensorsCalibrationPage />
=======
                    <DataTemplate DataType="vm:ResetParametersPageViewModel">
                        <views:ResetParametersPage />
>>>>>>> Stashed changes
                    </DataTemplate>
                </ContentControl.DataTemplates>
            </ContentControl>
        </Border>

        <!-- Modal overlay for parameter download -->
        <Border Grid.ColumnSpan="2"
                Background="#CC000000"
                IsVisible="{Binding IsParameterDownloadInProgress}"
                IsHitTestVisible="{Binding IsParameterDownloadInProgress}">
            <Border Background="White" 
                    Padding="40,30" 
                    CornerRadius="16" 
                    HorizontalAlignment="Center" 
                    VerticalAlignment="Center"
                    BoxShadow="0 10 40 0 #60000000"
                    MinWidth="400">
                <StackPanel Spacing="16" HorizontalAlignment="Center">
                    <!-- Loading Icon -->
                    <Border Width="64" 
                            Height="64" 
                            CornerRadius="32"
                            Background="#DBEAFE"
                            HorizontalAlignment="Center">
                        <Viewbox Width="32" Height="32">
                            <Canvas Width="24" Height="24">
                                <Path Fill="#3B82F6" 
                                      Data="M12 2v4m0 12v4M4.93 4.93l2.83 2.83m8.48 8.48l2.83 2.83M2 12h4m12 0h4M4.93 19.07l2.83-2.83m8.48-8.48l2.83-2.83"/>
                            </Canvas>
                        </Viewbox>
                    </Border>
                    
                    <TextBlock Text="Downloading Parameters" 
                               FontSize="20" 
                               FontWeight="Bold" 
                               HorizontalAlignment="Center"
                               Foreground="#111827"/>
                    
                    <TextBlock Text="{Binding ParameterDownloadStatusText}" 
                               FontSize="14" 
                               HorizontalAlignment="Center"
                               Foreground="#6B7280"/>
                    
                    <ProgressBar IsIndeterminate="True" 
                                 Width="300"
                                 Height="4"
                                 Foreground="#3B82F6"
                                 Background="#E5E7EB"/>
                </StackPanel>
            </Border>
        </Border>
    </Grid>

</Window>
