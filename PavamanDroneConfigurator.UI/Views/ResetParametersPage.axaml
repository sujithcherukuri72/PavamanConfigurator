<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:PavamanDroneConfigurator.UI.ViewModels"
             x:Class="PavamanDroneConfigurator.UI.Views.ResetParametersPage"
             x:DataType="vm:ResetParametersPageViewModel">

    <UserControl.Styles>
        <!-- Aviation-Grade Color System -->
        <Style Selector="TextBlock.PageTitle">
            <Setter Property="FontSize" Value="28"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#0B5ED7"/>
        </Style>
        
        <Style Selector="TextBlock.PageSubtitle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#64748B"/>
            <Setter Property="Margin" Value="0,4,0,0"/>
        </Style>
        
        <Style Selector="Border.SectionCard">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#E2E8F0"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="12"/>
            <Setter Property="Padding" Value="24"/>
            <Setter Property="Margin" Value="0,0,0,20"/>
        </Style>
        
        <Style Selector="TextBlock.SectionTitle">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#0B5ED7"/>
            <Setter Property="Margin" Value="0,0,0,4"/>
        </Style>
        
        <Style Selector="TextBlock.SectionSubtitle">
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Foreground" Value="#64748B"/>
            <Setter Property="Margin" Value="0,0,0,16"/>
        </Style>
        
        <Style Selector="TextBlock.WarningText">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#D92D20"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        
        <Style Selector="TextBlock.InfoText">
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Foreground" Value="#64748B"/>
            <Setter Property="TextWrapping" Value="Wrap"/>
        </Style>
        
        <Style Selector="Button.Primary">
            <Setter Property="Background" Value="#3B82F6"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        
        <Style Selector="Button.Primary:pointerover">
            <Setter Property="Background" Value="#2563EB"/>
        </Style>
        
        <Style Selector="Button.Primary:disabled">
            <Setter Property="Background" Value="#94A3B8"/>
            <Setter Property="Foreground" Value="#CBD5E1"/>
        </Style>
        
        <Style Selector="Button.Danger">
            <Setter Property="Background" Value="#DC2626"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Padding" Value="20,12"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="14"/>
        </Style>
        
        <Style Selector="Button.Danger:pointerover">
            <Setter Property="Background" Value="#B91C1C"/>
        </Style>
        
        <Style Selector="Button.Danger:disabled">
            <Setter Property="Background" Value="#94A3B8"/>
            <Setter Property="Foreground" Value="#CBD5E1"/>
        </Style>
        
        <Style Selector="Button.Secondary">
            <Setter Property="Background" Value="#6B7280"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="16,10"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>
        
        <Style Selector="Button.Secondary:pointerover">
            <Setter Property="Background" Value="#4B5563"/>
        </Style>
        
        <Style Selector="Button.Secondary:disabled">
            <Setter Property="Background" Value="#94A3B8"/>
            <Setter Property="Foreground" Value="#CBD5E1"/>
        </Style>
        
        <Style Selector="Border.AlertPanel">
            <Setter Property="CornerRadius" Value="10"/>
            <Setter Property="Padding" Value="20"/>
            <Setter Property="Margin" Value="0,16,0,16"/>
        </Style>
        
        <Style Selector="Border.AlertPanel.Warning">
            <Setter Property="Background" Value="#FEF3C7"/>
            <Setter Property="BorderBrush" Value="#F59E0B"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        
        <Style Selector="Border.AlertPanel.Danger">
            <Setter Property="Background" Value="#FEE2E2"/>
            <Setter Property="BorderBrush" Value="#DC2626"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        
        <Style Selector="Border.AlertPanel.Success">
            <Setter Property="Background" Value="#D1FAE5"/>
            <Setter Property="BorderBrush" Value="#10B981"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
        
        <Style Selector="Border.AlertPanel.Info">
            <Setter Property="Background" Value="#DBEAFE"/>
            <Setter Property="BorderBrush" Value="#3B82F6"/>
            <Setter Property="BorderThickness" Value="1"/>
        </Style>
    </UserControl.Styles>

    <ScrollViewer HorizontalScrollBarVisibility="Disabled" VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="24" MaxWidth="800">
            
            <!-- HEADER SECTION -->
            <StackPanel Margin="0,0,0,24">
                <TextBlock Classes="PageTitle" Text="RESET PARAMETERS"/>
                <TextBlock Classes="PageSubtitle" Text="Reset all drone parameters to factory defaults"/>
            </StackPanel>

            <!-- Connection Status -->
            <Border Classes="AlertPanel"
                    Classes.Info="{Binding IsConnected}"
                    Classes.Warning="{Binding !IsConnected}"
                    Margin="0,0,0,20">
                <StackPanel Orientation="Horizontal" Spacing="12">
                    <TextBlock FontSize="20" VerticalAlignment="Center"
                               Text="?" IsVisible="{Binding IsConnected}"/>
                    <TextBlock FontSize="20" VerticalAlignment="Center"
                               Text="?" IsVisible="{Binding !IsConnected}"/>
                    <TextBlock FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"
                               Text="Connected to drone" IsVisible="{Binding IsConnected}"/>
                    <TextBlock FontSize="14" FontWeight="SemiBold" VerticalAlignment="Center"
                               Text="Not connected - please connect to a drone first" IsVisible="{Binding !IsConnected}"/>
                </StackPanel>
            </Border>

            <!-- Warning Section -->
            <Border Classes="SectionCard">
                <StackPanel Spacing="16">
                    <TextBlock Classes="SectionTitle" Text="? Warning"/>
                    
                    <Border Classes="AlertPanel Danger">
                        <StackPanel Spacing="8">
                            <TextBlock FontSize="14" FontWeight="Bold" Foreground="#991B1B">
                                This action cannot be undone!
                            </TextBlock>
                            <TextBlock Classes="WarningText">
                                Resetting parameters will restore ALL drone settings to their factory default values. This includes:
                            </TextBlock>
                            <StackPanel Margin="12,8,0,0" Spacing="4">
                                <TextBlock Classes="WarningText">• PID tuning parameters</TextBlock>
                                <TextBlock Classes="WarningText">• Flight mode configurations</TextBlock>
                                <TextBlock Classes="WarningText">• Safety settings and failsafes</TextBlock>
                                <TextBlock Classes="WarningText">• Calibration offsets</TextBlock>
                                <TextBlock Classes="WarningText">• Motor and ESC configurations</TextBlock>
                                <TextBlock Classes="WarningText">• All custom configurations</TextBlock>
                            </StackPanel>
                        </StackPanel>
                    </Border>
                    
                    <TextBlock Classes="InfoText">
                        After resetting, you will need to recalibrate all sensors and reconfigure all settings. 
                        It is recommended to export your current parameters before proceeding.
                    </TextBlock>
                </StackPanel>
            </Border>

            <!-- Reset Process Section -->
            <Border Classes="SectionCard">
                <StackPanel Spacing="20">
                    <TextBlock Classes="SectionTitle" Text="Reset Process"/>
                    <TextBlock Classes="SectionSubtitle">
                        Follow these steps in order to reset your drone parameters:
                    </TextBlock>
                    
                    <!-- Step 1: Reset -->
                    <Border Background="#F8FAFC" CornerRadius="8" Padding="16">
                        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto">
                            <Border Grid.Column="0" Grid.RowSpan="2"
                                    Width="32" Height="32" CornerRadius="16"
                                    Background="#DC2626" Margin="0,0,16,0"
                                    VerticalAlignment="Top">
                                <TextBlock Text="1" Foreground="White" FontWeight="Bold"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Grid.Column="1" Grid.Row="0" 
                                       Text="Reset Parameters" FontWeight="Bold" FontSize="14"/>
                            <TextBlock Grid.Column="1" Grid.Row="1" 
                                       Text="Send reset command to prepare for factory reset"
                                       Foreground="#64748B" FontSize="12" Margin="0,4,0,0"/>
                            <Button Grid.Column="2" Grid.RowSpan="2"
                                    Classes="Danger"
                                    Content="Reset to Default"
                                    Command="{Binding ResetParametersCommand}"
                                    IsEnabled="{Binding IsConnected}"
                                    MinWidth="160"/>
                        </Grid>
                    </Border>
                    
                    <!-- Step 2: Reboot -->
                    <Border Background="#F8FAFC" CornerRadius="8" Padding="16">
                        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto">
                            <Border Grid.Column="0" Grid.RowSpan="2"
                                    Width="32" Height="32" CornerRadius="16"
                                    Background="#F59E0B" Margin="0,0,16,0"
                                    VerticalAlignment="Top">
                                <TextBlock Text="2" Foreground="White" FontWeight="Bold"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Grid.Column="1" Grid.Row="0" 
                                       Text="Reboot Drone" FontWeight="Bold" FontSize="14"/>
                            <TextBlock Grid.Column="1" Grid.Row="1" 
                                       Text="Restart the flight controller to apply the reset"
                                       Foreground="#64748B" FontSize="12" Margin="0,4,0,0"/>
                            <Button Grid.Column="2" Grid.RowSpan="2"
                                    Classes="Secondary"
                                    Content="Reboot Drone"
                                    Command="{Binding RebootDroneCommand}"
                                    IsEnabled="{Binding IsConnected}"
                                    MinWidth="160"/>
                        </Grid>
                    </Border>
                    
                    <!-- Step 3: Refresh -->
                    <Border Background="#F8FAFC" CornerRadius="8" Padding="16">
                        <Grid ColumnDefinitions="Auto,*,Auto" RowDefinitions="Auto,Auto">
                            <Border Grid.Column="0" Grid.RowSpan="2"
                                    Width="32" Height="32" CornerRadius="16"
                                    Background="#3B82F6" Margin="0,0,16,0"
                                    VerticalAlignment="Top">
                                <TextBlock Text="3" Foreground="White" FontWeight="Bold"
                                           HorizontalAlignment="Center" VerticalAlignment="Center"/>
                            </Border>
                            <TextBlock Grid.Column="1" Grid.Row="0" 
                                       Text="Refresh Parameters" FontWeight="Bold" FontSize="14"/>
                            <TextBlock Grid.Column="1" Grid.Row="1" 
                                       Text="Download the new default parameters from the drone"
                                       Foreground="#64748B" FontSize="12" Margin="0,4,0,0"/>
                            <Button Grid.Column="2" Grid.RowSpan="2"
                                    Classes="Primary"
                                    Content="Refresh Parameters"
                                    Command="{Binding RefreshParametersCommand}"
                                    IsEnabled="{Binding IsConnected}"
                                    MinWidth="160"/>
                        </Grid>
                    </Border>
                </StackPanel>
            </Border>

            <!-- Status Section -->
            <Border Classes="SectionCard">
                <StackPanel Spacing="12">
                    <TextBlock Classes="SectionTitle" Text="Status"/>
                    
                    <!-- Loading indicator -->
                    <StackPanel Orientation="Horizontal" Spacing="12" 
                                IsVisible="{Binding IsResetting}">
                        <ProgressBar IsIndeterminate="True" Width="120" Height="4"/>
                        <TextBlock Text="Resetting..." Foreground="#64748B"/>
                    </StackPanel>
                    
                    <!-- Rebooting indicator -->
                    <StackPanel Orientation="Horizontal" Spacing="12" 
                                IsVisible="{Binding IsRebooting}">
                        <ProgressBar IsIndeterminate="True" Width="120" Height="4"/>
                        <TextBlock Text="Rebooting..." Foreground="#64748B"/>
                    </StackPanel>
                    
                    <!-- Status message -->
                    <Border Background="#F1F5F9" CornerRadius="8" Padding="16">
                        <TextBlock Text="{Binding StatusMessage}" 
                                   TextWrapping="Wrap"
                                   FontSize="13"/>
                    </Border>
                    
                    <!-- Success message -->
                    <Border Classes="AlertPanel Success" IsVisible="{Binding ResetComplete}" Margin="0">
                        <StackPanel Spacing="8">
                            <TextBlock FontSize="14" FontWeight="Bold" Foreground="#065F46">
                                ? Reset Prepared Successfully
                            </TextBlock>
                            <TextBlock Classes="InfoText" Foreground="#065F46">
                                Now click 'Reboot Drone' to apply the reset, then 'Refresh Parameters' after reconnection.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Error message -->
                    <Border Classes="AlertPanel Danger" IsVisible="{Binding ResetFailed}" Margin="0">
                        <StackPanel Spacing="8">
                            <TextBlock FontSize="14" FontWeight="Bold" Foreground="#991B1B">
                                ? Reset Failed
                            </TextBlock>
                            <TextBlock Classes="WarningText">
                                The reset command failed. Please check the connection and try again.
                            </TextBlock>
                        </StackPanel>
                    </Border>
                    
                    <!-- Drone messages -->
                    <StackPanel IsVisible="{Binding LastDroneMessage, Converter={x:Static StringConverters.IsNotNullOrEmpty}}">
                        <TextBlock Text="Last Drone Message:" FontWeight="SemiBold" FontSize="12" Margin="0,8,0,4"/>
                        <Border Background="#1E293B" CornerRadius="6" Padding="12">
                            <TextBlock Text="{Binding LastDroneMessage}" 
                                       Foreground="#10B981" 
                                       FontFamily="Consolas, monospace"
                                       FontSize="12"/>
                        </Border>
                    </StackPanel>
                </StackPanel>
            </Border>

            <!-- Info Section -->
            <Border Background="#F0F9FF" CornerRadius="8" Padding="16" Margin="0,8,0,0">
                <StackPanel Orientation="Horizontal" Spacing="8">
                    <TextBlock Text="?" FontSize="16" VerticalAlignment="Top"/>
                    <TextBlock TextWrapping="Wrap" FontSize="12" Foreground="#0369A1">
                        <Run Text="Tip:"/>
                        <Run Text=" Before resetting parameters, use the 'Advanced Settings' page to export your current configuration. After reset, you will need to recalibrate accelerometer, compass, and other sensors."/>
                    </TextBlock>
                </StackPanel>
            </Border>
        </StackPanel>
    </ScrollViewer>
</UserControl>
